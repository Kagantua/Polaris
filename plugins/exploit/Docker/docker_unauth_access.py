# -*-* coding:UTF-8


class Plugin(Base):
    __info__ = {
        "name": "docker api未授权访问漏洞",
        "description": "Docker 是一个开源的引擎可以轻松地为任何应用创建一个轻量级的、可移植的、自给自足的容器。开发者在笔记本上编译测试通过的容器可以批量地在生产环境中部署包括 VMs、bare metal、OpenStack 集群和其他的基础应用平台Docker 存在问题的版本分别为 1.3 和 1.6因为权限控制等问题导致可以脱离容器拿到宿主机权限。默认端口：2375",
        "references": ["-"],
    }

    def url(self) -> dict:
        r = self.request(
            method='GET',
            path='./version',
            timeout=15
        )
        if r.status_code == 200 and 'Version' in r.text and 'BuildTime' in r.text and 'Components' in r.text:
            return {"LoopholeInfo": self.__info__}
