# -*-* coding:UTF-8


class Plugin(Base):
    __info__ = {
        "name": "F5 BIG-IP iControl REST 身份认证绕过漏洞",
        "description": "未经身份验证的攻击者可以通过管理端口或自身 IP 地址对 BIG-IP 系统进行网络访问，执行任意系统命令、创建或删除文件或禁用服务",
        "references": ["-"],
    }

    def url(self) -> dict:
        r = self.request(
            method='get',
            path='./mgmt/shared/authn/login',
            timeout=15
        )
        if 'resterrorresponse' in r.text and 'Authorization failed' in r.text:
            return {"LoopholeInfo": self.__info__}
