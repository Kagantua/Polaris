# -*-* coding:UTF-8


class Plugin(Base):
    __info__ = {
        "name": "Elasticsearch未授权访问漏洞",
        "description": "ElasticSearch 是一款Java编写的企业级搜索服务, 启动此服务默认会开放9200端口, 可被非法操作数据",
        "references": ["-"],
    }

    def __condition__(self):
        return self.condition(logic=(self.target.port == 9200))

    def url(self) -> dict:
        r = self.request(
            method='get',
            path='./_cat',
            timeout=15
        )
        if r.status_code == 200 and '/_cat/master' in r.text:
            return {"LoopholeInfo": self.__info__}
