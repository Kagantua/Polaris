# -*-* coding:UTF-8


class Plugin(Base):
    __info__ = {
        "name": "致远OA ajax.do 任意文件上传漏洞",
        "description": "致远OA是一套办公协同管理软件。近日，奇安信CERT监测到致远OA的相关漏洞信息。由于致远OA旧版本某些接口存在未授权访问，以及部分函数存在过滤不足，攻击者通过构造恶意请求，可在无需登录的情况下上传恶意脚本文件，从而控制服务器",
        "references": ["http://wiki.peiqi.tech/wiki/oa/致远OA/致远OA ajax.do 任意文件上传 CNVD-2021-01627.html"],
    }

    def url(self) -> dict:
        r = self.request(
            method='GET',
            path='./seeyon/thirdpartyController.do.css/..;/ajax.do',
            timeout=15
        )
        if "java.lang.NullPointerException:null" in r.text:
            return {"LoopholeInfo": self.__info__}
