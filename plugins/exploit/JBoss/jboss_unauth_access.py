# -*-* coding:UTF-8


class Plugin(Base):
    __info__ = {
        "name": "JBoss未授权访问漏洞",
        "description": "",
        "references": ["-"],
    }

    def __condition__(self):
        return self.condition(
            matches=[
                {
                    "search": "headers",
                    "keyword": "JBoss"
                },
                {
                    "search": "body",
                    "keyword": "jboss.css"
                }
            ]
        )

    def url(self) -> dict:
        r = self.request(
            method='get',
            path='./jmx-console',
            timeout=15
        )
        if r.status_code == 200 and 'Catalina' in r.text:
            return {"LoopholeInfo": self.__info__}
