# -*-* coding:UTF-8
import urllib.parse


class Plugin(Base):
    __info__ = {
        "author": "doimet",
        "references": ["-"],
        "name": "JBoss未授权访问漏洞",
        "description": "-",
        "datetime": "2022-02-27"
    }

    def url(self) -> dict:
        r = self.request(
            method='get',
            path='./jmx-console',
            timeout=15
        )
        if r.status_code == 200 and 'Catalina' in r.text:
            return {
                "LoopholeInfo": {"app": "JBoss", "name": "JBoss未授权访问漏洞"}
            }
